module Test.Parse.Variable exposing ( tests )

import Expect exposing (Expectation)
import Test exposing (Test, describe, test)
import Parser.Advanced as Parser
import Parse.Variable as PV


tests : Test
tests =
    describe "Parse.Variable"
        [ describe "Lower case"
            [ test "Simple case" <| \_ ->
                Parser.run PV.lowerCase "myvar"
                    |> Expect.equal (Ok "myvar")
            ]
        ]


expectErr : PV.Error -> Result (Array (Parser.DeadEnd c PV.Error)) String -> Expectation
expectErr expected result =
    when result is
        Ok _ ->
            Expect.fail "Expected error"

        Err problems ->
            when Array.first problems is
                Just firstProblem ->
                    Expect.equal expected firstProblem.problem

                Nothing ->
                    Expect.fail "Failed, but with no problems..."
